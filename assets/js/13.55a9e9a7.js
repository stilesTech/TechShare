(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{446:function(e,s,r){e.exports=r.p+"assets/img/2303071062.3a9232e5.png"},447:function(e,s,r){e.exports=r.p+"assets/img/2144204738.f44e8422.png"},448:function(e,s,r){e.exports=r.p+"assets/img/3807803297.e7d78cdb.png"},449:function(e,s,r){e.exports=r.p+"assets/img/3603667446.db86fd66.png"},450:function(e,s,r){e.exports=r.p+"assets/img/2502187957.36afd53e.png"},575:function(e,s,r){"use strict";r.r(s);var t=r(10),d=Object(t.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"centos上搭建redis集群"}},[e._v("centos上搭建redis集群")]),e._v(" "),s("p",[e._v("简介：Redis 集群是一个可以在多个 Redis 节点之间进行数据共享的设施（installation）。")]),e._v(" "),s("p",[s("strong",[e._v("集群的理解")]),e._v("为何使用集群：解决单机故障，和单台服务器性能瓶颈的问题")]),e._v(" "),s("p",[e._v("提升系统负载，引入集群也引入了集群间节点通信和数据同步的一致性问题，和系统高可用的问题。")]),e._v(" "),s("p",[s("img",{attrs:{src:r(446),alt:"../uploads/2020/10/2303071062.png"}})]),e._v(" "),s("p",[s("strong",[e._v("1.安装环境依赖")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yum -y install gcc automake autoconf libtool make\nyum install gcc-c++\n")])])]),s("p",[s("strong",[e._v("2.下载redis软件包，解压并安装")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(" cd /usr/local/software\n wget <http://download.redis.io/releases/redis-5.0.3.tar.gz>\n tar xzf redis-5.0.3.tar.gz\n cd redis-5.0.3\n make && make install\n")])])]),s("p",[s("img",{attrs:{src:r(447),alt:"../uploads/2020/10/2144204738.png"}})]),e._v(" "),s("p",[s("strong",[e._v("3.建立软件以及节点运行目录，复制配置文件")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd /usr/local\nmkdir redis-cluster\ncd redis-cluster\nmkdir redis-node-7000 redis-node-7001 redis-node-7002 redis-node-7003 redis-node-7004 redis-node-7005 redis-node-7006\nredis-node-7007\ncd redis-node1\nmkdir logs data\ncd /usr/local/software/redis-5.0.3\ncp redis.conf /usr/local/redis-cluster/redis-node-7000\ncp redis.conf /usr/local/redis-cluster/redis-node-7001\ncp redis.conf /usr/local/redis-cluster/redis-node-7002\ncp redis.conf /usr/local/redis-cluster/redis-node-7003\ncp redis.conf /usr/local/redis-cluster/redis-node-7004\ncp redis.conf /usr/local/redis-cluster/redis-node-7005\ncp redis.conf /usr/local/redis-cluster/redis-node-7006\ncp redis.conf /usr/local/redis-cluster/redis-node-7007\n\ncd src\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7000\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7001\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7002\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7003\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7004\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7005\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7006\ncp redis-cli redis-server   /usr/local/redis-cluster/redis-node-7007\n")])])]),s("p",[s("strong",[e._v("4.修改配置文件")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('cd /usr/local/redis-cluster/redis-node-7000\nvi redis.conf\n--文件内容如下\nport 7000 //端口7000,7002,7003..\nbind 本机ip //默认ip为127.0.0.1 需要改为其他节点机器可访问的ip 否则创建集群时无法访问对应的端口，无法创建集群\ndaemonize yes //redis后台运行\npidfile /usr/local/redis-cluster/redis-node-7000/redis_7000.pid //pidfile文件对应7000,7001,7002,7003,7004,7005,7006,7007\ncluster-enabled yes //开启集群 把注释#去掉\ncluster-config-file nodes_7000.conf //集群的配置 配置文件首次启动自动生成 7000,7001,7002,7003..\ncluster-node-timeout 15000 //请求超时 默认15秒，可自行设置\nappendonly yes //aof日志开启 有需要就开启，它会每次写操作都记录一条日志\nlogfile "/usr/local/redis-cluster/redis-node-7000/logs/redis_7000.log" //配置日志文件路径 dir "/usr/local/redis-cluster/redis-5.0.3-node/data"　　//配置数据文件存放路径\ndir "/usr/local/redis-cluster/redis-node-7000/data"\n')])])]),s("p",[s("strong",[e._v("5.启动各个节点")]),e._v("cd /usr/local/redis-cluster/redis-node-7000")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("redis-server redis.conf\n")])])]),s("p",[e._v("查看启动情况")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ps -ef | grep redis\n")])])]),s("p",[s("img",{attrs:{src:r(448),alt:"../uploads/2020/10/3807803297.png"}})]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("6.初始化集群（节点列表顺序用于确定主从角色，先主节点之后是从节点）\n\ncd /usr/local/redis-cluster\n\nredis-cli  --cluster create  --cluster-replicas  1  192.168.50.230:7000 192.168.50.230:7001  192.168.50.230:7002 192.168.50.230:7003  192.168.50.230:7004  192.168.50.230:7005 192.168.50.230:7006 192.168.50.230:7007\n")])])]),s("p",[s("img",{attrs:{src:r(449),alt:"../uploads/2020/10/3603667446.png"}})]),e._v(" "),s("p",[e._v("查看集群信息")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("redis-cli -c -h 192.168.50.230 -p 7000\ncluster info\n")])])]),s("p",[s("img",{attrs:{src:r(450),alt:"../uploads/2020/10/2502187957.png"}})]),e._v(" "),s("p",[e._v("检查集群信息")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("redis-cli --cluster check 192.168.50.230:7000\n")])])]),s("p",[s("strong",[e._v("参考资料")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/coes/p/9031939.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("centos7快速搭建redis集群环境"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/qq_36514588/article/details/83856795",target:"_blank",rel:"noopener noreferrer"}},[e._v("redis5.0.0集群搭建-centos7"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"http://www.mamicode.com/info-detail-1843956.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装redis出现cc adlist.0 /bin/sh:1:cc:not found"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=d.exports}}]);